# AI を活用した執筆ワークフロー

このガイドでは、「結果から投稿への道のり」アプローチにもとづき、VS Code と AI アシスタント (GitHub Copilot／Claude) を組み合わせて論文を執筆する手順を、まったくの VS Code 初心者でも迷わないレベルまで分解して説明します。

## 0. 事前準備チェックリスト

必要なものと最低限の確認ポイントをチェックしてください。

| 必要なもの                       | 最低限の確認ポイント                                                       |
| -------------------------------- | -------------------------------------------------------------------------- |
| □ VS Code (最新)                 | 日本語 UI でも OK。拡張機能 GitHub Copilot / Copilot Chat が入っているか？ |
| □ Cline の設定                   | ブラウザで開け、resources/prompts/\*.prompt をコピペできる状態か？         |
| □ 当リポジトリをローカルに clone | docs/ と resources/prompts/ が見えるか？                                   |

💡 **Tips**: Copilot Chat パネルは Ctrl + Shift + i（または Command⌘ + i）でトグル表示できます。キーバインドは個人設定で変えても OK。

## 1. 「結果から投稿への道のり」アプローチの全体像

```mermaid
graph LR
  A[結果の整理] -->|ボトムラインメッセージ| B(結果セクション)
  B --> C(方法セクション)
  C --> D(考察セクション)
  D --> E(背景セクション)
  E --> F(要旨)
  F --> G[最終原稿]
```

## 2. 結果の整理とボトムラインメッセージの明確化

ゴール: 研究結果を整理し、論文全体を通して伝えたい最も重要なメッセージ（ボトムラインメッセージ）を明確にします。

### 2-1. 統計結果のまとめファイルを準備

1. プロジェクト直下に results/ フォルダを作成
   - VS Code エクスプローラで右クリック → 「新しいフォルダ」→ 「results」と入力
2. すべての図 (PNG, PDF など) と表 (CSV, XLSX など) をここに配置
   - エクスプローラからドラッグ＆ドロップするか、コピー＆ペーストで移動

### 2-2. ボトムラインメッセージの生成

#### Cline の場合

1. 論文用の新規ファイルを作成する
   - templates フォルダからテンプレートをコピーして新しいファイルを作成 (例: draft.md)
2. Cline のチャット画面を開く

   - VSCode の左側のツールバーからロボットアイコン（Cline）をクリック
   - 画面下部の切り替えボタンで「Plan」モードを選択

3. 分析結果を Cline に読み込ませる

   - チャット入力欄に「@」を入力し、統計結果フォルダを選択
   - 同様に「@resources/reporting_guidelines/STROBE.md」と入力して STROBE ガイドラインも読み込む
   - これにより、AI が結果とガイドラインを理解した状態になる

4. ボトムラインメッセージの生成を依頼

   - 「この結果から論文のボトムラインメッセージを生成してください」と指示
   - 必要に応じて、主要結果や臨床的重要性についても補足情報を加える

5. 生成結果を論文ファイルに反映
   - AI が生成したボトムラインメッセージをコピー
   - 論文ファイルの適切な位置（通常考察の最後）に貼り付け

#### GitHub Copilot の場合

1. 論文用の新規ファイルを作成する

   - templates フォルダからテンプレートをコピーして新しいファイルを作成 (例: draft.md)

2. Copilot Chat を開く

   - (STROBE.md)[resources/reporting_guidelines/STROBE.md]を開く
   - Ctrl+Shift+i（または Command⌘+i）で Copilot Chat パネルを表示
   - または、VS Code の左側のアクティビティバーから Copilot アイコンをクリック
   - チャット画面の右下に`STROBE.md`と表示されていることを確認

3. 統計結果を Copilot Chat に伝える

   - チャット画面の Add context ボタンから、folder を選び、results フォルダを認識させる

4. 必要に応じて追加情報を提供

   - 研究デザイン、対象者、介入内容などの情報を追加
   - 例：「この研究は 2 型糖尿病患者 100 名を対象とした 12 週間のコホート研究です」

5. 生成結果を論文に反映
   - Copilot が提案したボトムラインメッセージをコピー
   - 論文ファイルの適切な位置に貼り付け

## 3. 結果セクションの執筆

ゴール: 図表・グラフを根拠に、読者が一目で主要結果を理解できる本文を作る。STROBE チェックリストに準拠させる。

### 3-1. 結果セクションの追加

1. 前のステップで作成した draft.md を開く
2. なければ、「## Results」という見出しを追加

### 3-2. AI を活用した STROBE 準拠アウトラインの作成

#### Cline の場合

1. Cline のチャット画面を開く

   - VSCode の左側のツールバーからロボットアイコン（Cline）をクリック
   - 画面下部の切り替えボタンで「Plan」モードを選択

2. STROBE.md をコンテキストとして提供

   - `resources/reporting_guidelines/STROBE.md`を VS Code で開く
   - 全選択 (Ctrl+A) → コピー (Ctrl+C)
   - Cline ウィンドウに貼り付ける

3. 以下のプロンプトを Cline に送信

   > プロトコルファイルがあるなら、それを@で参照してもらうだけでも良いです。

   ```
   STROBE基準に準拠した結果セクションのアウトラインを作成してください。
   以下のコンテキストを考慮してください：
   - 研究タイプ: [研究タイプを記入]
   - 対象者: [対象者情報を記入]
   - 主要アウトカム: [主要アウトカム名を記入]
   - 統計解析手法: [使用した統計手法を記入]

   以下の点を含めてください：
   - 冒頭に参加者数と主要アウトカムの概要を簡潔に記述
   - 記述的データ、主要結果、サブグループ分析を別々のサブセクションで整理
   - 図表は番号順に引用（Figure 1, Table 1など）
   ```

4. 生成されたアウトラインを draft.md の「## Results」見出しの下に貼り付け
   - 必要に応じて編集・修正

#### GitHub Copilot の場合

1. draft.md を開いた状態で Copilot Chat (Ctrl+Shift+i) を開く

2. STROBE.md を参照させる

   - チャット画面の「Add context」ボタンをクリック
   - 「File」を選択し、`resources/reporting_guidelines/STROBE.md`を追加

3. 以下のプロンプトを Copilot Chat に送信

   ```
   STROBE基準に準拠した結果セクションのアウトラインを作成してください。
   以下のコンテキストを考慮してください：
   - 研究タイプ: [研究タイプを記入]
   - 対象者: [対象者情報を記入]
   - 主要アウトカム: [主要アウトカム名を記入]
   - 統計解析手法: [使用した統計手法を記入]

   以下の点を含めてください：
   - 冒頭に参加者数と主要アウトカムの概要を簡潔に記述
   - 記述的データ、主要結果、サブグループ分析を別々のサブセクションで整理
   - 図表は番号順に引用（Figure 1, Table 1など）
   ```

4. 図表を追加コンテキストとして提供

   - チャット画面の「Add context」ボタンから「Folder」を選択
   - results フォルダを選択（または図表ファイルを個別に追加）

5. Copilot が返した結果セクションを draft.md の「## Results」見出しの下に貼り付ける

### 3-3. 図表に基づいた本文の肉付け

1. 生成されたアウトラインの各サブセクションに、実際の統計結果を反映させる

   - 各図表を参照しながら、具体的な数値・比率・信頼区間などを追記
   - 統計的有意性や臨床的意義について言及

2. AI を活用して図表の説明文を生成
   - 図表を見せながら「この[図/表]の内容を結果セクションにふさわしい形で説明してください」と依頼
   - 生成された説明を適切な位置に挿入

### 3-4. STROBE 準拠の確認と校正

#### Cline の場合

1. 作成した結果セクションの評価を依頼

   - @記号を使ってファイル参照する方法（推奨）:

     ```
     @draft.md

     上記の結果セクション部分をSTROBEガイドラインに照らし合わせて評価し、不足している項目や改善点を指摘してください。
     ```

2. 返ってきた提案で不足項目や表現を修正
   - Cline が指摘した STROBE ガイドラインの不足項目を中心に修正
   - 提案された表現の改善を取り入れる

#### GitHub Copilot の場合

1. draft.md の結果セクション部分を選択

2. Copilot Chat (Ctrl+Shift+i) を開き、以下のプロンプトを送信

   ```
   選択中のテキストはSTROBEガイドラインに準拠した結果セクションですか？
   不足している項目があれば指摘し、改善案を提案してください。
   ```

3. 提案された修正を適用
   - 必要に応じて手動で修正を加える

### 3-5. 図表番号リンクの整合性確認

1. VS Code マーケットプレイスから「Markdown References」拡張機能をインストール
   - VS Code の左サイドバーの拡張機能アイコンをクリック
   - 「Markdown References」を検索してインストール
2. draft.md 内で Alt+Shift+F を押して Figure/Table 番号と本文リンクを自動更新

📝 **ヒント**:

- 図表を説明する際は「〜を示している」だけでなく、実際の数値や傾向に言及するとより具体的になります
- 統計的有意差だけでなく、効果量や臨床的意義にも言及することで、結果の解釈が深まります
- Copilot にフォルダパスを渡すときは、スペースを含む場合、`"C:\Users\...\My Results\figures"`のように引用符で囲むと誤解釈を防げます

## 4. 方法 (Methods) セクションの執筆 ― 超初心者向けステップバイステップ

ゴール: 再現性を担保できるだけの情報を、読みやすい段落構成で書く。

### 4‑1. スニペットでアウトラインを生成

1. カーソルを置く位置: results.md の末尾に空行を入れた直後
   - ファイル末尾に移動 (Ctrl+End)
   - Enter キーで空行を挿入
2. Copilot Chat を開く (Ctrl+Shift+i)
3. 「#methods」とだけ入力 → Enter
4. 出てきたアウトライン案 (研究デザイン／対象／介入…など) を Tab キーで確定

💡 **VS Code の超基本操作**: Tab = 提案を採用 / Esc = 無視

### 4‑2. 各小見出しを AI に肉付けしてもらう

各小見出しごとに以下の手順を繰り返します：

| 小見出し             | Copilot Chat に貼るプロンプト例                                         |
| -------------------- | ----------------------------------------------------------------------- |
| Participants         | 以下の研究概要に基づき、参加者の選択基準と除外基準を 100 字以内で書いて |
| Outcomes             | 主要アウトカムの測定方法を STROBE ガイドラインに沿って詳述して          |
| Statistical analysis | 生存時間解析 (Cox) で報告すべき項目を列挙し、文章化して                 |

1. 小見出しの下にカーソルを置く
2. Copilot Chat でプロンプトを送信
3. 返された文をコピーして貼り付け
4. 自分の言葉で微修正（必要に応じて）

🛠 **トラブルシューティング**: Copilot が応答しない場合は:

1. VS Code を再起動
2. GitHub: Sign in を再実行（VS Code の左下にあるアカウントアイコンから）
3. インターネット接続を確認

## 5. 考察 (Discussion) セクションの執筆 ― 段落テンプレート付き

### 5‑1. まずは段落の "骨" を書く

1. 方法セクションの後に以下のテンプレートを挿入:

```markdown
## Discussion

### Main Findings

(2 行で主要知見)

### Comparison with Previous Studies

()

### Strengths and Limitations

()

### Clinical Implications

()

### Future Research

()
```

**時短技**: Copilot Chat で `#discussion` と入力すると上記の雛形が一発で挿入されます。

### 5‑2. 各段落を肉付け

各段落を以下の手順で肉付けします:

1. **Main Findings**: Copilot Chat に「この研究の主結果は何ですか？ 70 字以内で簡潔に」と質問

   - 返ってきた回答を修正して採用

2. **Comparison**:

   - 先行文献を列挙（キーワードのみで OK）
   - Copilot Chat に「これらの文献を踏まえて、どこが一致／相違か箇条書きで」と指示

3. **Strengths & Limitations**:

   - Claude に「この研究の限界を 3 点、強みを 2 点まとめて」と依頼
   - 返された内容を整理して採用

4. **Clinical Implications**と**Future Research**:
   - 同様に Copilot Chat を使って内容を生成
   - 必要に応じて自分の知識で補完

### 5‑3. 段落を滑らかにつなぐ

1. 最後に Copilot Chat へ以下を指示:

```
以下の Discussion を読みやすい順序に並べ替え、論理の飛躍をなくして 400 語に整形して
```

2. 全文をコピーして貼り付け
3. 提案を採用するか、必要に応じて手修正

## 6. 背景 (Introduction) セクションを逆算で書く

ゴール: 研究の背景と目的を明確に伝え、読者が「なぜこの研究が必要なのか」を理解できるようにする。

### 6-1. 構造を作る

1. 新しいファイルを作成するか、既存ファイルの先頭に以下の構造を追加:

```markdown
## Introduction

### 研究の動機

(Why-now? ギャップを 1 文で)

### 現状と課題

(最新システマティックレビューを引用)

### 目的

(「本研究の目的は…」で締める)
```

**時短技**: Copilot Chat で `#introduction` と入力すると上記の雛形が挿入されます。

### 6-2. 各セクションを肉付け

1. **研究の動機**:

   - Copilot Chat に「この研究領域の最大のギャップは何か、50 字で」と質問
   - 回答を編集して採用

2. **現状と課題**:

   - 関連する最新のシステマティックレビューや重要論文を引用
   - Copilot Chat に「以下の文献から現状の課題を 3 点まとめて」と指示

3. **目的**:
   - 「本研究の目的は...」という形式で、研究目的を明確に 1 文で記述
   - 必要に応じて仮説も追記

### 6-3. Claude で文章を洗練

1. `resources/prompts/refinement.prompt` を使って文章を洗練
   - Methods セクションと同様の手順で実施
   - 対象セクションを「Introduction」に変更

## 7. 要旨 (Abstract) の作成

ゴール: 論文の核心を 定められた語以内にまとめ、読者が本文を読まなくても研究の概要を理解できるようにする。

### 7-1. Copilot Chat で要旨の骨組みを作成

1. Copilot Chat を開き、以下のプロンプトを送信:

```
この論文の Structured Abstract を 250 語、IMRaD 形式で作成してください。
以下は論文の主要ポイントです：
- 研究目的：(ここに記入)
- 方法：(ここに記入)
- 主要結果：(ここに記入)
- 結論：(ボトムラインメッセージを含める)
```

2. 必要な情報を埋めて送信
3. 生成された要旨をコピーしてファイルに保存

### 7-2. Cline で雑誌スタイルに合わせる

1. `resources/prompts/refinement.prompt` を使用

   - 対象セクションを「Abstract」に設定
   - 具体的な対象ジャーナル名を指定（例: The Lancet, NEJM など）

2. 返ってきた洗練された要旨を採用

## 8. Copilot Chat コマンド早見表

| 入力例       | 何が起きる？                      |
| ------------ | --------------------------------- |
| #imrad       | 空の IMRaD セクションが展開される |
| #methods     | Methods テンプレート展開          |
| リライトして | 選択範囲を言い換え提案            |
| 英語にして   | 選択範囲を英訳                    |

💡 **英訳の精度が落ちたら** Claude に丸投げすると高品質になることが多い。

## 9. 全セクション完成後のチェックリスト

| 確認項目         | 詳細                            |
| ---------------- | ------------------------------- |
| □ 引用キー       | 本文と .bib に一致しているか？  |
| □ 図表番号       | 本文参照がずれていないか？      |
| □ 統計値         | n, %, CI にタイプミスはないか？ |
| □ AI 生成文      | 事実誤認がないか？              |
| □ スペルチェック | プレーンテキストを必ず確認      |

## 10. 次のステップ

AI を活用した執筆フローを習得したら、03_git_gov.md に進み、共同執筆の Git 運用とガバナンスを学びましょう。
